<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WhatsApp Admin Rulesetting Demo</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      padding: 20px;
      background: #f5f5f5;
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
      font-size: 24px;
    }

    .condition-selector {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .condition-selector h2 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #555;
    }

    .radio-group {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .radio-option input[type="radio"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .radio-option label {
      cursor: pointer;
      font-size: 16px;
      color: #333;
    }

    .content-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 1024px) {
      .content-container {
        grid-template-columns: 1fr;
      }
    }

    .mock-chat-container {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .mock-chat-container h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #555;
      align-self: flex-start;
    }

    .iframe-wrapper {
      width: 100%;
      max-width: 500px;
      display: flex;
      justify-content: center;
      overflow: visible;
    }

    .figma-embed {
      width: 500px;
      height: 900px;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transform-origin: top center;
    }

    /* Mobile responsive scaling */
    @media (max-width: 768px) {
      .iframe-wrapper {
        max-width: 100%;
        overflow: visible;
      }

      .figma-embed {
        transform: scale(0.7);
        height: 900px;
        margin-bottom: -270px; /* Adjust for scale: 900 * (1 - 0.7) = 270 */
      }
    }

    @media (max-width: 480px) {
      .figma-embed {
        transform: scale(0.6);
        margin-bottom: -360px; /* Adjust for scale: 900 * (1 - 0.6) = 360 */
      }
    }

    @media (max-width: 380px) {
      .figma-embed {
        transform: scale(0.5);
        margin-bottom: -450px; /* Adjust for scale: 900 * (1 - 0.5) = 450 */
      }
    }

    .rule-input-container {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: none;
    }

    .rule-input-container.active {
      display: block;
    }

    .rule-input-container h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #555;
    }

    .prompt-input-group {
      margin-bottom: 15px;
    }

    .prompt-input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
    }

    .prompt-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 80px;
    }

    .prompt-input:focus {
      outline: none;
      border-color: #25D366;
      box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
    }

    .generate-btn {
      background: #25D366;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 15px;
    }

    .generate-btn:hover {
      background: #20BA5A;
    }

    .generate-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .rules-output {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 300px;
    }

    .rules-output:focus {
      outline: none;
      border-color: #25D366;
      box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
    }

    .loading-indicator {
      display: none;
      color: #666;
      font-style: italic;
      margin: 10px 0;
    }

    .loading-indicator.active {
      display: block;
    }

    .info-text {
      color: #666;
      font-size: 14px;
      margin-top: 10px;
      font-style: italic;
    }

    .error-message {
      background: #fee;
      color: #c33;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      display: none;
    }

    .error-message.active {
      display: block;
    }
  </style>
</head>
<body>
  <h1>Mock Family WhatsApp Group Scenario</h1>

  <!-- Instructions -->
  <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <h2 style="font-size: 18px; margin-bottom: 15px; color: #555;">Instructions</h2>
    <p style="margin-bottom: 10px; line-height: 1.6;">On the left, you will see a mock WhatsApp group conversation from a family group. Please:</p>
    <ul style="margin-left: 20px; margin-bottom: 15px; line-height: 1.8;">
      <li><strong>Scroll through the conversation</strong> as you would on your phone, from top to bottom.</li>
      <li><strong>Read all the messages carefully</strong> to understand the group dynamics, interactions, and any issues that may arise.</li>
      <li><strong>Imagine you are the admin</strong> of this WhatsApp group.</li>
      <li><strong>Think about what rules you would set</strong> to promote the well-being of the group, reduce potential conflicts, maintain respectful communication, and ensure a positive environment for all members.</li>
    </ul>
    <p style="margin-bottom: 10px; line-height: 1.6;">After reviewing the conversation, you will write rules for this group. Consider what guidelines would help the group function better and prevent issues from escalating.</p>
  </div>

  <div class="condition-selector">
    <h2>Select Testing Condition:</h2>
    <div class="radio-group">
      <div class="radio-option">
        <input type="radio" id="condition1" name="condition" value="1">
        <label for="condition1">Human Only</label>
      </div>
      <div class="radio-option">
        <input type="radio" id="condition2" name="condition" value="2" checked>
        <label for="condition2">Human + AI</label>
      </div>
    </div>
  </div>

  <div class="content-container">
    <!-- Mock WhatsApp Chat -->
    <div class="mock-chat-container">
      <h3>Family WhatsApp Group</h3>
      <div class="iframe-wrapper">
        <iframe
          id="whatsapp-iframe"
          class="figma-embed"
          src="whatsapp-mock/index.html"
          width="500"
          height="900"
          frameborder="0">
        </iframe>
      </div>
    </div>

    <!-- Rule Input Section -->
    <div>
      <!-- Condition 1: Human Only -->
      <div id="condition1-ui" class="rule-input-container">
        <h3>Write Your Rules</h3>
        <p class="info-text" style="margin-bottom: 15px; line-height: 1.6;">Based on what you observed in the WhatsApp conversation, write the rules you would set for this group as an admin. Think about guidelines that would help maintain a healthy group environment.</p>
        <textarea
          id="human-only-textarea"
          class="rules-output"
          placeholder="Write your rules here..."></textarea>
        <button id="submit-btn-c1" class="generate-btn" style="margin-top: 15px;">Submit</button>
        <p class="info-text">Once you are satisfied with your rules, press Submit to continue.</p>
      </div>

      <!-- Condition 2: Human + AI -->
      <div id="condition2-ui" class="rule-input-container active">
        <h3>Collaborate with AI</h3>
        <p class="info-text" style="margin-bottom: 15px; line-height: 1.6;">The AI has access to all the messages in the WhatsApp conversation. You can ask the AI to help you generate rules based on what you want to achieve for the group. Describe your preferences, and the AI will suggest rules accordingly.</p>
        <div class="error-message" id="error-message-c2"></div>

        <div class="prompt-input-group">
          <label for="user-prompt">Your Prompt to AI:</label>
          <textarea
            id="user-prompt"
            class="prompt-input"
            placeholder="Example: Read the group conversation and generate rules that promote respectful communication and maintain group harmony..."></textarea>
        </div>

        <button id="generate-btn-c2" class="generate-btn">Generate Rules</button>
        <div class="loading-indicator" id="loading-c2">Generating Rules -- wait a moment</div>

        <div class="prompt-input-group">
          <label for="ai-rules-c2">Generated Rules (editable):</label>
          <textarea
            id="ai-rules-c2"
            class="rules-output"
            placeholder="AI-generated rules will appear here. You can edit them after generation."></textarea>
        </div>
        <p class="info-text" style="margin-bottom: 15px; line-height: 1.6; background: #fffbea; padding: 12px; border-left: 4px solid #f59e0b; border-radius: 4px;"><strong>Important:</strong> Please feel free to edit the generated rules in the box above to match your preferences. You can adjust the tone, language, add or remove rules, or make any other changes. <strong>It is most important that you are fully satisfied with the final rules.</strong> The AI suggestions are just a starting point!</p>
        <button id="submit-btn-c2" class="generate-btn" style="margin-top: 15px;">Submit</button>
        <p class="info-text">You can refine your prompt and regenerate rules as many times as you want. Once you are satisfied with the rules, press Submit to continue.</p>
      </div>

    </div>
  </div>

  <!-- Navigation Buttons -->
  <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: center;">
    <button id="back-btn" style="padding: 12px 24px; background: #ccc; color: #333; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer;">Back</button>
    <button id="continue-btn" style="padding: 12px 24px; background: #25D366; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer;" disabled>Continue</button>
  </div>

  <script src="write_rules.js"></script>
</body>
</html>
