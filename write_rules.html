<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WhatsApp Admin Rulesetting Demo</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      padding: 20px;
      background: #f5f5f5;
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
      font-size: 24px;
    }

    .content-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    /* Tablet and larger screens: keep side-by-side layout */
    /* Only stack on mobile devices (smaller than 768px) */
    @media (max-width: 767px) {
      .content-container {
        grid-template-columns: 1fr;
      }

      /* Ensure WhatsApp mock is clearly visible and full-size on mobile */
      .mock-chat-container {
        order: 1; /* WhatsApp mock appears first */
        margin-bottom: 20px;
      }

      .rule-input-wrapper {
        order: 2; /* Rule input appears below WhatsApp mock */
      }

      /* Make iframe more visible on mobile */
      .iframe-wrapper {
        max-width: 100%;
      }

      .figma-embed {
        width: 100%;
        max-width: 500px;
        /* Enable zoom/pinch on mobile */
        touch-action: manipulation;
      }

      .mock-chat-container h3 {
        font-size: 14px;
        line-height: 1.4;
      }
    }

    .mock-chat-container {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .mock-chat-container h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #555;
      align-self: flex-start;
      width: 100%;
      max-width: 500px;
      word-wrap: break-word;
      line-height: 1.4;
    }

    .iframe-wrapper {
      width: 100%;
      max-width: 500px;
      display: flex;
      justify-content: center;
      overflow: visible;
    }

    .figma-embed {
      width: 500px;
      height: 900px;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transform-origin: top center;
    }

    /* Mobile responsive scaling */
    @media (max-width: 768px) {
      .iframe-wrapper {
        max-width: 100%;
        overflow: visible;
      }

      .figma-embed {
        transform: scale(0.7);
        height: 900px;
        margin-bottom: -270px; /* Adjust for scale: 900 * (1 - 0.7) = 270 */
      }
    }

    @media (max-width: 480px) {
      .figma-embed {
        transform: scale(0.6);
        margin-bottom: -360px; /* Adjust for scale: 900 * (1 - 0.6) = 360 */
      }
    }

    @media (max-width: 380px) {
      .figma-embed {
        transform: scale(0.5);
        margin-bottom: -450px; /* Adjust for scale: 900 * (1 - 0.5) = 450 */
      }
    }

    .rule-input-container {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: none;
    }

    .rule-input-container.active {
      display: block;
    }

    .rule-input-container h3 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #555;
    }

    .prompt-input-group {
      margin-bottom: 15px;
    }

    .prompt-input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
    }

    .prompt-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 80px;
    }

    .prompt-input:focus {
      outline: none;
      border-color: #25D366;
      box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
    }

    .generate-btn {
      background: #25D366;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 15px;
      transition: all 0.2s ease;
    }

    .generate-btn:hover {
      background: #20BA5A;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(37, 211, 102, 0.3);
    }

    .generate-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* Make Submit buttons more prominent */
    #submit-btn-c1,
    #submit-btn-c2 {
      margin-top: 25px;
      padding: 14px 32px;
      font-size: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      min-width: 200px;
    }

    #submit-btn-c1:hover:not([disabled]),
    #submit-btn-c2:hover:not([disabled]) {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4);
    }

    .rules-output {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      min-height: 300px;
    }

    .rules-output:focus {
      outline: none;
      border-color: #25D366;
      box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
    }

    .loading-indicator {
      display: none;
      color: #666;
      font-style: italic;
      margin: 10px 0;
    }

    .loading-indicator.active {
      display: block;
    }

    .info-text {
      color: #666;
      font-size: 14px;
      margin-top: 10px;
      font-style: italic;
    }

    .error-message {
      background: #fee;
      color: #c33;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      display: none;
    }

    .error-message.active {
      display: block;
    }

    /* Requirements indicator */
    .requirements-indicator {
      margin-top: 12px;
      padding: 12px 16px;
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      border-radius: 4px;
      font-size: 14px;
      line-height: 1.6;
      color: #856404;
    }

    .requirements-indicator.all-complete {
      background: #d4edda;
      border-left-color: #28a745;
      color: #155724;
    }

    .requirements-indicator .warning-icon {
      font-size: 16px;
      margin-right: 4px;
    }

    .requirements-indicator ul {
      margin: 8px 0 0 0;
      padding-left: 20px;
      list-style: none;
    }

    .requirements-indicator li {
      margin: 4px 0;
      position: relative;
      padding-left: 24px;
    }

    .requirements-indicator li::before {
      content: '•';
      position: absolute;
      left: 0;
      font-weight: bold;
    }

    .requirements-indicator li.completed::before {
      content: '✓';
      color: #28a745;
      font-weight: bold;
    }

    .requirements-indicator li.completed {
      color: #28a745;
      text-decoration: line-through;
    }

    /* Additional responsive improvements */
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }

      h1 {
        font-size: 20px;
        margin-bottom: 15px;
      }

      .mock-chat-container h3 {
        font-size: 14px;
      }

      .info-text {
        font-size: 13px;
      }

      .generate-btn {
        padding: 10px 20px;
        font-size: 13px;
      }

      .prompt-input,
      .rules-output {
        font-size: 13px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <h1>Family WhatsApp Group Scenario</h1>

  <!-- Instructions -->
  <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <h2 style="font-size: 18px; margin-bottom: 15px; color: #555;">Instructions</h2>
    <p style="margin-bottom: 10px; line-height: 1.6;">On the left, you will see a WhatsApp group conversation from a family group. Please:</p>
    <ul style="margin-left: 20px; margin-bottom: 15px; line-height: 1.8;">
      <li><strong>Please read the whole conversation by scrolling down.</strong> Scroll through the conversation as you would on your phone, from top to bottom.</li>
      <li><strong>Read all the messages carefully</strong> to understand the group dynamics, interactions, and any issues that may arise.</li>
      <li><strong>Imagine you are the admin</strong> of this WhatsApp group.</li>
      <li><strong>Think about what rules you would set</strong> to promote the well-being of the group, reduce potential conflicts, maintain respectful communication, and ensure a positive environment for all members.</li>
    </ul>
    <p style="margin-bottom: 10px; line-height: 1.6;">After reviewing the conversation, you will write rules for this group. Consider what guidelines would help the group function better and prevent issues from escalating.</p>
  </div>

  <div class="content-container">
    <!-- WhatsApp Chat -->
    <div class="mock-chat-container">
      <h3 style="color: #000; font-weight: normal; line-height: 1.5;">
        Scroll the WhatsApp group interface to read all the messages in the group. Understand the conversation before you write the rules for this group. <span style="color: #1565C0; font-weight: bold;">You will only be compensated if you review the whole conversation.</span>
      </h3>
      <div class="iframe-wrapper">
        <iframe
          id="whatsapp-iframe"
          class="figma-embed"
          src="whatsapp-mock/index.html"
          width="500"
          height="900"
          frameborder="0">
        </iframe>
      </div>
    </div>

    <!-- Rule Input Section -->
    <div class="rule-input-wrapper">
      <!-- Condition 1: Human Only -->
      <div id="condition1-ui" class="rule-input-container">
        <h3>Write Your Rules</h3>
        <p class="info-text" style="margin-bottom: 15px; line-height: 1.6;">Based on what you observed in the WhatsApp conversation, write the rules you would set for this group as an admin. Think about guidelines that would help maintain a healthy group environment. <span style="color: #1565C0; font-weight: bold;">List each rule clearly and descriptively so others can easily understand them. Submit only the rules, no other text.</span></p>
        <textarea
          id="human-only-textarea"
          class="rules-output"
          placeholder="Write your rules here..."></textarea>
        <button id="submit-btn-c1" class="generate-btn">Submit and continue</button>
        <div id="requirements-c1" class="requirements-indicator">
          <span class="warning-icon">⚠️</span> To submit, you need to:
          <ul>
            <li id="req-scroll-c1">Read and understand the entire conversation</li>
            <li id="req-rules-c1">Write more substantively</li>
          </ul>
        </div>
      </div>

      <!-- Condition 2: Human + AI -->
      <div id="condition2-ui" class="rule-input-container active">
        <h3>Collaborate with AI</h3>
        <p class="info-text" style="margin-bottom: 15px; line-height: 1.6;">The AI has access to all the messages in the WhatsApp conversation. You can ask the AI to help you generate rules based on what you want to achieve for the group. Describe your preferences, and the AI will suggest rules accordingly. Every time you click the "Send to AI" button, the AI is going to write new content in the canvas below that you can edit. You can send instructions to AI as many times as you want.</p>
        <div class="error-message" id="error-message-c2"></div>

        <div class="prompt-input-group">
          <label for="user-prompt">Your Prompt to AI:</label>
          <textarea
            id="user-prompt"
            class="prompt-input"
            placeholder="Example: Read the group conversation and generate rules that promote respectful communication and maintain group harmony..."></textarea>
        </div>

        <button id="generate-btn-c2" class="generate-btn">Send to AI</button>
        <div class="loading-indicator" id="loading-c2">Generating Rules -- wait a moment</div>

        <p class="info-text" style="margin-top: 15px; margin-bottom: 15px; line-height: 1.6; background: #fffbea; padding: 12px; border-left: 4px solid #f59e0b; border-radius: 4px;"><strong>Important:</strong> <span style="color: #1565C0; font-weight: bold;">Make sure to submit the rules in a list, one after another and no other irrelevant text.</span> Feel free to edit the generated rules in the box below to match your preferences. You can adjust the tone, language, add or remove rules, or make any other changes. <strong>It is most important that you are fully satisfied with the final rules.</strong></p>

        <div class="prompt-input-group">
          <textarea
            id="ai-rules-c2"
            class="rules-output"
            placeholder="AI-generated rules will appear here. You can edit them after generation."></textarea>
        </div>

        <button id="submit-btn-c2" class="generate-btn">Submit and continue</button>
        <div id="requirements-c2" class="requirements-indicator">
          <span class="warning-icon">⚠️</span> To submit, you need to:
          <ul>
            <li id="req-scroll-c2">Read and understand the entire conversation</li>
            <li id="req-ai-c2">Prompt the AI to generate rules and edit the rules as per your liking</li>
          </ul>
        </div>
      </div>

    </div>
  </div>

  <script src="write_rules.js"></script>
</body>
</html>
